---
layout: lay_post
title: "正则表达式正确入门"
date: 2020-03-28
categories: 正则表达式
tags: 工具
author: lvyafei
---

## 1.规则
<!--more-->

### 1.1 匹配位置（定位符）

```
^  匹配输入字符串的开始位置
$  匹配输入字符串的结束位置
\b   匹配一个单词边界，也就是指单词和空格间的位置
\B   匹配非单词边界，与\b相反
```

### 1.2 指定匹配内容

```
x|y     匹配x或y
[xyz]   匹配字符集合中的任意一个字符
[^xyz]  匹配未包含字符集合中的任意字符
[a-z]   匹配指定字符范围内的任意字符
[^a-z]  匹配任何不在指定范围内的任意字符
```

### 1.3 匹配任意字符

```
.  匹配除换行符（\n、\r）之外的任何单个字符。要匹配包括 '\n' 在内的任何字符，请使用像"(.|\n)"的模式。
```

### 1.4 匹配次数（限定符）

格式：<匹配内容><匹配次数>

```
*     匹配前面的子表达式零次或多次
+     匹配前面的子表达式一次或多次
?     匹配前面的子表达式零次或一次
{n}   匹配确定的n次
{n,}  至少匹配n次
{n,m} 最少匹配n次且最多匹配m次

?  当该字符紧跟在任何一个其他限制符 (*, +, ?, {n}, {n,}, {n,m}) 后面时，匹配模式是非贪婪的
```

### 1.5 子表达式

```
( ) 标记一个子表达式的开始和结束位置。子表达式可以获取供以后使用。要匹配这些字符，请使用 \( 和 \)
```

### 1.6 获取匹配、非获取匹配

获取匹配
```
(pattern)  匹配pattern并获取这一匹配
```

非获取匹配
```
(?:pattern)   匹配pattern但不获取匹配结果
(?=pattern)   正向肯定预查（look ahead positive assert），在任何匹配pattern的字符串开始处匹配查找字符串
(?!pattern)   正向否定预查(negative assert)，在任何不匹配pattern的字符串开始处匹配查找字符串
(?<=pattern)  反向(look behind)肯定预查，与正向肯定预查类似，只是方向相反
(?<!pattern)  反向否定预查，与正向否定预查类似，只是方向相反
```

### 1.7 转义字符

```
\   转义字符
```

### 1.8 控制字符匹配

```
\cx  匹配由 x 指明的控制字符。例如， \cM 匹配一个 Control-M 或回车符。
```

### 1.9 快捷匹配

```
\d  匹配一个数字字符。等价于 [0-9]
\D  匹配一个非数字字符。等价于 [^0-9]
\f  匹配一个换页符。等价于 \x0c 和 \cL
\n  匹配一个换行符。等价于 \x0a 和 \cJ
\r  匹配一个回车符。等价于 \x0d 和 \cM
\s  匹配任何空白字符，包括空格、制表符、换页符等等。等价于 [ \f\n\r\t\v]
\S  匹配任何非空白字符。等价于 [^ \f\n\r\t\v]
\t  匹配一个制表符。等价于 \x09 和 \cI
\v  匹配一个垂直制表符。等价于 \x0b 和 \cK
\w  匹配字母、数字、下划线。等价于'[A-Za-z0-9_]'
\W  匹配非字母、数字、下划线。等价于 '[^A-Za-z0-9_]'
```

### 1.10 十六进制数匹配

```
\xn  匹配 n，其中 n 为十六进制转义值。十六进制转义值必须为确定的两个数字长
\un  n 是一个用四个十六进制数字表示的 Unicode 字符。例如， \u00A9 匹配版权符号 (?)
```

### 1.11 八进制数匹配

```
\n   如果 n 为八进制数字 (0-7)，则 n 为一个八进制转义值
\nm  将匹配八进制转义值 nm

\n   如果 \n 之前至少 n 个获取的子表达式，则 n 为向后引用
\nm  如果 \nm 之前至少有 nm 个获得子表达式，则 nm 为向后引用。如果 \nm 之前至少有 n 个获取，则 n 为一个后跟文字 m 的向后引用

\nml 如果 n 为八进制数字 (0-3)，且 m 和 l 均为八进制数字 (0-7)，则匹配八进制转义值 nml
```

### 1.12 引用回溯

```
\num  对所获取的匹配的引用。例如，'(.)\1' 匹配两个连续的相同字符
```

## 2.实战

### 2.1 查找字符

文本：
```
采购专用发票 PAULSH190905008, UNICO LDGISTICS CO...操作部, KATE.ZHU, 
采购专用发票 PAULSHI90906002, UICO LDGISTICS CO...操作部, KATE.ZHU, 
采购专用发票 PAULSHI90906003, UICO UDGISTICS CO...操作部, KATE.ZHU, 
采购专用发票 PAULSH190906005, UNICO LDGISTICS C0...操作部, KATE.ZHU, 
采购专用发票 PAULSH190908008, UICO LDGISTICS CO...操作部, KATE.ZHU, 
采购专用发票 PAULSHI90906011, UNICO LDGISTICS CO...操作部, KATE.ZHU, 
```

正则：

```
采购专用发票.+[0-9]{2}
```

### 2.2 替换查找

工具：vscode

文本：
```
224276|901500014949|StopProfit|3|000510|新金路|{"profitRatio":"10","costPrice":4.614}
224182|918700000075|StopProfit|3|300241|瑞丰光电|{"lossRatio":"-6.5","costPrice":6.702}
224216|918700000075|StopProfit|3|000534|万泽股份|{"lossRatio":"-2.2","costPrice":9.683}
```

正则：

```
查找：\{"(\w+)":"(\d+)","(\w+)":([\d].*)

替换：参数:$1,值:$2,参数:$3,值:$4
```

结果:
```
224276|901500014949|StopProfit|3|000510|新金路|参数:profitRatio,值:10,参数:costPrice,值:4.614}
224182|918700000075|StopProfit|3|300241|瑞丰光电|{"lossRatio":"-6.5","costPrice":6.702}
224216|918700000075|StopProfit|3|000534|万泽股份|{"lossRatio":"-2.2","costPrice":9.683}
```

### 2.3 去除重复行

工具：sublime,vscode

文本:

```
918700000015
918700000045
918700000075
918700000075
918700000075
918700000095
918700000105
918700000115
```

正则：

```
查找：^(.+)$[\r\n](^\1$[\r\n]{0,1})+

替换(sublime)：\1\n
替换(vscode)：$1\n
```

## 3.常用示例

### 3.1 校验数字的表达式

```
数字：^[0-9]*$
n位的数字：^\d{n}$
至少n位的数字：^\d{n,}$
m-n位的数字：^\d{m,n}$
零和非零开头的数字：^(0|[1-9][0-9]*)$
非零开头的最多带两位小数的数字：^([1-9][0-9]*)+(\.[0-9]{1,2})?$
带1-2位小数的正数或负数：^(\-)?\d+(\.\d{1,2})$
正数、负数、和小数：^(\-|\+)?\d+(\.\d+)?$
有两位小数的正实数：^[0-9]+(\.[0-9]{2})?$
有1~3位小数的正实数：^[0-9]+(\.[0-9]{1,3})?$
非零的正整数：^[1-9]\d*$ 或 ^([1-9][0-9]*){1,3}$ 或 ^\+?[1-9][0-9]*$
非零的负整数：^\-[1-9][]0-9"*$ 或 ^-[1-9]\d*$
非负整数：^\d+$ 或 ^[1-9]\d*|0$
非正整数：^-[1-9]\d*|0$ 或 ^((-\d+)|(0+))$
非负浮点数：^\d+(\.\d+)?$ 或 ^[1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0$
非正浮点数：^((-\d+(\.\d+)?)|(0+(\.0+)?))$ 或 ^(-([1-9]\d*\.\d*|0\.\d*[1-9]\d*))|0?\.0+|0$
正浮点数：^[1-9]\d*\.\d*|0\.\d*[1-9]\d*$ 或 ^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$
负浮点数：^-([1-9]\d*\.\d*|0\.\d*[1-9]\d*)$ 或 ^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$
浮点数：^(-?\d+)(\.\d+)?$ 或 ^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$
```

### 3.2 校验字符的表达式

```
汉字：^[\u4e00-\u9fa5]{0,}$
英文和数字：^[A-Za-z0-9]+$ 或 ^[A-Za-z0-9]{4,40}$
长度为3-20的所有字符：^.{3,20}$
由26个英文字母组成的字符串：^[A-Za-z]+$
由26个大写英文字母组成的字符串：^[A-Z]+$
由26个小写英文字母组成的字符串：^[a-z]+$
由数字和26个英文字母组成的字符串：^[A-Za-z0-9]+$
由数字、26个英文字母或者下划线组成的字符串：^\w+$ 或 ^\w{3,20}$
中文、英文、数字包括下划线：^[\u4E00-\u9FA5A-Za-z0-9_]+$
中文、英文、数字但不包括下划线等符号：^[\u4E00-\u9FA5A-Za-z0-9]+$ 或 ^[\u4E00-\u9FA5A-Za-z0-9]{2,20}$
可以输入含有^%&',;=?$\"等字符：[^%&',;=?$\x22]+
禁止输入含有~的字符：[^~\x22]+
```

### 3.3 特殊需求表达式

```
Email地址：^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$
域名：[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+\.?
InternetURL：[a-zA-z]+://[^\s]* 或 ^http://([\w-]+\.)+[\w-]+(/[\w-./?%&=]*)?$
手机号码：^(13[0-9]|14[5|7]|15[0|1|2|3|4|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$
电话号码("XXX-XXXXXXX"、"XXXX-XXXXXXXX"、"XXX-XXXXXXX"、"XXX-XXXXXXXX"、"XXXXXXX"和"XXXXXXXX)：^(\(\d{3,4}-)|\d{3.4}-)?\d{7,8}$
国内电话号码(0511-4405222、021-87888822)：\d{3}-\d{8}|\d{4}-\d{7}
电话号码正则表达式（支持手机号码，3-4位区号，7-8位直播号码，1－4位分机号）: ((\d{11})|^((\d{7,8})|(\d{4}|\d{3})-(\d{7,8})|(\d{4}|\d{3})-(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1}))$)
身份证号(15位、18位数字)，最后一位是校验位，可能为数字或字符X：(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)
帐号是否合法(字母开头，允许5-16字节，允许字母数字下划线)：^[a-zA-Z][a-zA-Z0-9_]{4,15}$
密码(以字母开头，长度在6~18之间，只能包含字母、数字和下划线)：^[a-zA-Z]\w{5,17}$
强密码(必须包含大小写字母和数字的组合，不能使用特殊字符，长度在 8-10 之间)：^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])[a-zA-Z0-9]{8,10}$
强密码(必须包含大小写字母和数字的组合，可以使用特殊字符，长度在8-10之间)：^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,10}$
日期格式：^\d{4}-\d{1,2}-\d{1,2}
一年的12个月(01～09和1～12)：^(0?[1-9]|1[0-2])$
一个月的31天(01～09和1～31)：^((0?[1-9])|((1|2)[0-9])|30|31)$s
xml文件：^([a-zA-Z]+-?)+[a-zA-Z0-9]+\\.[x|X][m|M][l|L]$
中文字符的正则表达式：[\u4e00-\u9fa5]
双字节字符：[^\x00-\xff] (包括汉字在内，可以用来计算字符串的长度(一个双字节字符长度计2，ASCII字符计1))
空白行的正则表达式：\n\s*\r (可以用来删除空白行)
HTML标记的正则表达式：<(\S*?)[^>]*>.*?|<.*? /> ( 首尾空白字符的正则表达式：^\s*|\s*$或(^\s*)|(\s*$) (可以用来删除行首行尾的空白字符(包括空格、制表符、换页符等等)，非常有用的表达式)
腾讯QQ号：[1-9][0-9]{4,} (腾讯QQ号从10000开始)
中国邮政编码：[1-9]\d{5}(?!\d) (中国邮政编码为6位数字)
IP地址：((?:(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d))
```

钱的输入格式：
```
1.有四种钱的表示形式我们可以接受:"10000.00" 和 "10,000.00", 和没有 "分" 的 "10000" 和 "10,000"：^[1-9][0-9]*$
2.这表示任意一个不以0开头的数字,但是,这也意味着一个字符"0"不通过,所以我们采用下面的形式：^(0|[1-9][0-9]*)$
3.一个0或者一个不以0开头的数字.我们还可以允许开头有一个负号：^(0|-?[1-9][0-9]*)$
4.这表示一个0或者一个可能为负的开头不为0的数字.让用户以0开头好了.把负号的也去掉,因为钱总不能是负的吧。下面我们要加的是说明可能的小数部分：^[0-9]+(.[0-9]+)?$
5.必须说明的是,小数点后面至少应该有1位数,所以"10."是不通过的,但是 "10" 和 "10.2" 是通过的：^[0-9]+(.[0-9]{2})?$
6.这样我们规定小数点后面必须有两位,如果你认为太苛刻了,可以这样：^[0-9]+(.[0-9]{1,2})?$
7.这样就允许用户只写一位小数.下面我们该考虑数字中的逗号了,我们可以这样：^[0-9]{1,3}(,[0-9]{3})*(.[0-9]{1,2})?$
8.1到3个数字,后面跟着任意个 逗号+3个数字,逗号成为可选,而不是必须：^([0-9]+|[0-9]{1,3}(,[0-9]{3})*)(.[0-9]{1,2})?$
9.备注：这就是最终结果了,别忘了"+"可以用"*"替代如果你觉得空字符串也可以接受的话(奇怪,为什么?)最后,别忘了在用函数时去掉去掉那个反斜杠,一般的错误都在这里
```

## 4.参考

![正则表达式必知必会](/images/正则表达式/必知必会.png)

blog 笔记: https://www.cnblogs.com/dingdangsunny/p/11253386.html