---
layout: lay_post
title: "正则表达式正确入门"
date: 2020-03-28
categories: 正则表达式
tags: 工具
author: lvyafei
---

## 1 规则

### 1.1 匹配位置（定位符）

```
^  匹配输入字符串的开始位置
$  匹配输入字符串的结束位置
\b   匹配一个单词边界，也就是指单词和空格间的位置
\B   匹配非单词边界，与\b相反
```

### 1.2 指定匹配内容

```
x|y     匹配x或y
[xyz]   匹配字符集合中的任意一个字符
[^xyz]  匹配未包含字符集合中的任意字符
[a-z]   匹配指定字符范围内的任意字符
[^a-z]  匹配任何不在指定范围内的任意字符
```

### 1.3 匹配任意字符

```
.  匹配除换行符（\n、\r）之外的任何单个字符
    ---要匹配包括 '\n' 在内的任何字符，请使用像"(.|\n)"的模式。
```

### 1.4 匹配次数（限定符）

格式：<匹配内容><匹配次数>

```
*     匹配前面的子表达式零次或多次
+     匹配前面的子表达式一次或多次
?     匹配前面的子表达式零次或一次
{n}   匹配确定的n次
{n,}  至少匹配n次
{n,m} 最少匹配n次且最多匹配m次

?  当该字符紧跟在任何一个其他限制符 (*, +, ?, {n}, {n,}, {n,m}) 后面时，匹配模式是非贪婪的
```

### 1.5 子表达式

```
( ) 标记一个子表达式的开始和结束位置。子表达式可以获取供以后使用。要匹配这些字符，请使用 \( 和 \)
```

### 1.6 获取匹配、非获取匹配

获取匹配
```
(pattern)  匹配pattern并获取这一匹配
```

非获取匹配
```
(?:pattern)   匹配pattern但不获取匹配结果
(?=pattern)   正向肯定预查（look ahead positive assert），在任何匹配pattern的字符串开始处匹配查找字符串
(?!pattern)   正向否定预查(negative assert)，在任何不匹配pattern的字符串开始处匹配查找字符串
(?<=pattern)  反向(look behind)肯定预查，与正向肯定预查类似，只是方向相反
(?<!pattern)  反向否定预查，与正向否定预查类似，只是方向相反
```

### 1.7 转义字符

```
\   转义字符
```

### 1.8 控制字符匹配

```
\cx  匹配由 x 指明的控制字符。例如， \cM 匹配一个 Control-M 或回车符。
```

### 1.9 快捷匹配

```
\d  匹配一个数字字符。等价于 [0-9]
\D  匹配一个非数字字符。等价于 [^0-9]
\f  匹配一个换页符。等价于 \x0c 和 \cL
\n  匹配一个换行符。等价于 \x0a 和 \cJ
\r  匹配一个回车符。等价于 \x0d 和 \cM
\s  匹配任何空白字符，包括空格、制表符、换页符等等。等价于 [ \f\n\r\t\v]
\S  匹配任何非空白字符。等价于 [^ \f\n\r\t\v]
\t  匹配一个制表符。等价于 \x09 和 \cI
\v  匹配一个垂直制表符。等价于 \x0b 和 \cK
\w  匹配字母、数字、下划线。等价于'[A-Za-z0-9_]'
\W  匹配非字母、数字、下划线。等价于 '[^A-Za-z0-9_]'
```

### 1.10 十六进制数匹配

```
\xn  匹配 n，其中 n 为十六进制转义值。十六进制转义值必须为确定的两个数字长
\un  n 是一个用四个十六进制数字表示的 Unicode 字符。例如， \u00A9 匹配版权符号 (?)
```

### 1.11 八进制数匹配

```
\n   如果 n 为八进制数字 (0-7)，则 n 为一个八进制转义值
\nm  将匹配八进制转义值 nm

\n   如果 \n 之前至少 n 个获取的子表达式，则 n 为向后引用
\nm  如果 \nm 之前至少有 nm 个获得子表达式，则 nm 为向后引用。如果 \nm 之前至少有 n 个获取，则 n 为一个后跟文字 m 的向后引用

\nml 如果 n 为八进制数字 (0-3)，且 m 和 l 均为八进制数字 (0-7)，则匹配八进制转义值 nml
```

### 1.12 引用回溯

```
\num  对所获取的匹配的引用。例如，'(.)\1' 匹配两个连续的相同字符
```

## 2 实战

### 2.1 查找字符

文本：
```
采购专用发票 PAULSH190905008, UNICO LDGISTICS CO...操作部, KATE.ZHU, 
采购专用发票 PAULSHI90906002, UICO LDGISTICS CO...操作部, KATE.ZHU, 
采购专用发票 PAULSHI90906003, UICO UDGISTICS CO...操作部, KATE.ZHU, 
采购专用发票 PAULSH190906005, UNICO LDGISTICS C0...操作部, KATE.ZHU, 
采购专用发票 PAULSH190908008, UICO LDGISTICS CO...操作部, KATE.ZHU, 
采购专用发票 PAULSHI90906011, UNICO LDGISTICS CO...操作部, KATE.ZHU, 
```

正则：

```
采购专用发票.+[0-9]{2}
```

## 2.2 替换查找

工具：vscode

文本：
```
224276|901500014949|StopProfit|3|000510|新金路|{"profitRatio":"10","costPrice":4.614}
224182|918700000075|StopProfit|3|300241|瑞丰光电|{"lossRatio":"-6.5","costPrice":6.702}
224216|918700000075|StopProfit|3|000534|万泽股份|{"lossRatio":"-2.2","costPrice":9.683}
```

正则：

```
查找：\{"(\w+)":"(\d+)","(\w+)":([\d].*)

替换：参数:$1,值:$2,参数:$3,值:$4
```

结果:
```
224276|901500014949|StopProfit|3|000510|新金路|参数:profitRatio,值:10,参数:costPrice,值:4.614}
224182|918700000075|StopProfit|3|300241|瑞丰光电|{"lossRatio":"-6.5","costPrice":6.702}
224216|918700000075|StopProfit|3|000534|万泽股份|{"lossRatio":"-2.2","costPrice":9.683}
```

## 2.3 去除重复行

工具：sublime,vscode

文本:

```
918700000015
918700000045
918700000075
918700000075
918700000075
918700000095
918700000105
918700000115
```

正则：

```
查找：^(.+)$[\r\n](^\1$[\r\n]{0,1})+

替换(sublime)：\1\n
替换(vscode)：$1\n
```

## 3 参考

![正则表达式必知必会](/images/正则表达式/必知必会.png)

blog 笔记: https://www.cnblogs.com/dingdangsunny/p/11253386.html